<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wheelie Life | Simulador Arcade de Física Detallado</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        /* --- Variables CSS (Paleta) --- */
        :root {
            --color-bg-deep: #121212; /* Negro muy profundo */
            --color-bg-section: #1F1F1F; /* Gris oscuro para contenido */
            --color-bg-nav: #292929; /* Gris medio para barra de navegación */
            --color-accent: #FFB300; /* Ámbar/Amarillo Anaranjado */
            --color-text-light: #E0E0E0;
            --color-text-dim: #A0A0A0;
            --color-border: #444444;
            --color-success: #66BB6A;
            --color-error: #EF5350;
            --color-info: #64B5F6;
        }

        /* --- Base General y Tipografía --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-bg-deep);
            color: var(--color-text-light);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        a {
            color: var(--color-accent);
            text-decoration: none;
            transition: color 0.3s;
        }

        a:hover {
            color: #FFD54F;
        }

        /* --- Estructura Semántica (Nav/Header/Main) --- */
        nav {
            background-color: var(--color-bg-nav);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
            border-bottom: 2px solid var(--color-accent);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .nav-logo {
            font-family: 'Press Start 2P', cursive;
            font-size: 1em;
            color: var(--color-accent);
        }

        .nav-links a {
            margin-left: 20px;
            font-weight: 600;
            color: var(--color-text-light);
            text-transform: uppercase;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.3s, color 0.3s;
        }
        
        .nav-links a:not(.active):hover {
            background-color: var(--color-bg-section);
            color: var(--color-accent);
        }

        .nav-links a.active {
            color: var(--color-bg-deep);
            background-color: var(--color-accent);
            box-shadow: 0 0 10px rgba(255, 179, 0, 0.7);
        }
        
        .nav-toggle { /* Botón de hamburguesa */
            display: none;
            font-size: 1.5em;
            background: none;
            border: none;
            color: var(--color-text-light);
            cursor: pointer;
        }

        header {
            text-align: center;
            padding: 100px 0 50px;
            background: linear-gradient(180deg, #1A1A1A 0%, #000000 100%);
            border-bottom: 1px solid var(--color-border);
        }

        .game-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 4em;
            color: var(--color-text-light);
            text-shadow: 0 0 8px rgba(255, 179, 0, 0.4);
            margin-bottom: 5px;
        }

        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px 80px;
        }

        /* --- Lógica SPA: Ocultar/Mostrar Secciones --- */
        .content-section {
            padding: 40px;
            margin-bottom: 30px;
            border-radius: 8px;
            background-color: var(--color-bg-section);
            border: 1px solid var(--color-border);
            display: none; 
            animation: fadeIn 0.5s ease-out;
        }

        .content-section.active {
            display: block; 
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2em;
            color: var(--color-accent);
            text-align: center;
            border-bottom: 2px solid var(--color-border);
            padding-bottom: 15px;
            margin-bottom: 30px;
        }

        /* --- Elementos de Contenido --- */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }

        .grid-item {
            padding: 20px;
            background-color: #2F2F2F;
            border-radius: 6px;
            border-left: 3px solid var(--color-accent);
        }

        .grid-item h3 {
            font-size: 1.1em;
            margin-top: 0;
            color: var(--color-text-light);
        }

        .stats-table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
            margin-top: 15px;
        }

        .stats-table th, .stats-table td {
            border-bottom: 1px solid var(--color-border);
            padding: 8px 0;
            font-size: 0.9em;
        }
        
        .stats-table th {
            color: var(--color-accent);
            font-weight: 600;
        }

        /* --- Estilos de Formularios (Login/Registro) --- */
        .form-container {
            max-width: 450px;
            margin: 20px auto;
            padding: 25px;
            background-color: #2F2F2F;
            border-radius: 6px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-text-dim);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            background-color: var(--color-bg-deep);
            border: 1px solid var(--color-border);
            border-radius: 4px;
            color: var(--color-text-light);
            font-size: 1em;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--color-accent);
            box-shadow: 0 0 8px rgba(255, 179, 0, 0.5);
        }

        .form-btn {
            width: 100%;
            padding: 15px;
            background: var(--color-accent);
            color: var(--color-bg-deep);
            border-radius: 4px;
            font-weight: 800;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s;
        }

        .form-btn:hover {
            background-color: #FFD54F;
        }

        /* --- Botones de Descarga por OS --- */
        .os-download-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .os-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 30px;
            background-color: #2F2F2F;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            color: var(--color-text-light);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .os-btn i {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .os-btn.enabled:hover {
            border-color: var(--color-accent);
            background-color: #3a3a3a;
            transform: translateY(-5px);
        }

        .os-btn.disabled {
            color: #666;
            cursor: not-allowed;
            position: relative;
        }

        .os-btn.disabled::after {
            content: 'Próximamente';
            position: absolute;
            bottom: 5px;
            font-size: 0.7em;
            color: #888;
        }

        /* --- Estilos de la Ventana Modal --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none; /* Oculto por defecto */
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--color-bg-section);
            padding: 30px 40px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            position: relative;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.5);
        }

        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2.5em;
            cursor: pointer;
            color: var(--color-text-dim);
            transition: color 0.3s;
        }
        .modal-close-btn:hover { color: var(--color-text-light); }

        /* --- Footer --- */
        footer {
            padding: 30px;
            background-color: #000000;
            border-top: 2px solid var(--color-border);
            text-align: center;
            font-size: 0.85em;
            color: var(--color-text-dim);
        }

        /* --- Clases de Utilidad --- */
        .text-center { text-align: center; }
        .font-large { font-size: 1.1em; }
        .font-small { font-size: 0.9em; }
        .color-accent { color: var(--color-accent); }
        .color-dim { color: var(--color-text-dim); }
        .color-success { color: var(--color-success); }
        .color-error { color: var(--color-error); }
        .color-info { color: var(--color-info); }
        .fw-bold { font-weight: bold; }
        .fw-600 { font-weight: 600; }
        .mt-1 { margin-top: 10px; }
        .mt-2 { margin-top: 20px; }
        .mt-3 { margin-top: 30px; }

        /* --- Media Queries para Diseño Adaptable --- */
        @media (max-width: 992px) {
            .nav-links {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: var(--color-bg-nav);
                padding: 10px 0;
            }
            .nav-links.active { display: flex; }
            .nav-links a { margin: 5px 20px; text-align: center; }
            .nav-toggle { display: block; }
            #nav-auth-container, #nav-links-user { display: none !important; } /* Ocultar en el menú colapsado */
        }

        @media (max-width: 768px) {
            .game-title { font-size: 2.5em; }
            header { padding: 60px 0 30px; }
            main { padding: 20px 10px 40px; }
            .content-section { padding: 20px; }
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="nav-container">
            <a href="#" class="nav-logo">WHEELIE LIFE</a>
            <div class="nav-links">
                <a href="#" data-target="download-content" class="active"><i class="fas fa-file-download"></i> Descarga</a>
                <a href="#" data-target="overview-content"><i class="fas fa-info-circle"></i> Visión General</a>
                <a href="#" data-target="documentation-content"><i class="fas fa-book-open"></i> Documentación Técnica</a>
                <a href="#" data-target="shop-content"><i class="fas fa-store"></i> Catálogo de Skins</a>
                <a href="#" data-target="changelog-content"><i class="fas fa-history"></i> Historial</a>
            </div>
            <button class="nav-toggle" id="nav-toggle-btn"><i class="fas fa-bars"></i></button>
            <div id="nav-auth-container" class="nav-links">
                <a href="#" id="login-modal-btn"><i class="fas fa-sign-in-alt"></i> Iniciar Sesión</a>
                <a href="#" id="register-modal-btn"><i class="fas fa-user-plus"></i> Registrarse</a>
            </div>
            <div id="nav-links-user" class="nav-links" style="display: none;">
                <span id="user-greeting" style="color: var(--color-text-dim); margin-right: 15px;"></span>
                <a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
            </div>
        </div>
    </nav>

    <header>
        <h1 class="game-title">WHEELIE LIFE</h1>
        <p class="tagline color-accent fw-600"></p>
        <p class="version-display"><i class="fas fa-code-branch"></i> Versión Estable: <span id="game-version">1.1.0</span></p>
    </header>

    <main id="main-content-container">

        <section id="download-content" class="info-section content-section active">
            <h2 class="section-title">DESCARGA E INSTALACIÓN <i class="fas fa-arrow-down"></i></h2>
            <p class="text-center font-large">Obtén el proyecto completo en un paquete ZIP. Incluye todo el código fuente, los assets gráficos y de sonido, y el archivo de datos iniciales.</p>
            
            <div class="os-download-container">
                <a href="https://drive.google.com/uc?export=download&id=1HHuHpnFQYaJsHSHflcPOE11r12ByEO6n" class="os-btn enabled" download="WheelieLife_v1.1.0.zip">
                    <i class="fab fa-windows" style="color: #00A4EF;"></i>
                    <span>Windows</span>
                </a>
                <a href="#" class="os-btn disabled">
                    <i class="fab fa-linux" style="color: #FCC624;"></i>
                    <span>Linux</span>
                </a>
                <a href="#" class="os-btn disabled">
                    <i class="fab fa-apple" style="color: #A2AAAD;"></i>
                    <span>macOS</span>
                </a>
                <a href="#" class="os-btn disabled">
                    <i class="fab fa-android" style="color: #3DDC84;"></i>
                    <span>Android</span>
                </a>
            </div>
            
            <div class="grid-2 mt-3">
                <div class="grid-item">
                    <h3><i class="fas fa-terminal color-accent"></i> Requisitos de Entorno</h3>
                    <ul style="list-style:none; padding:0;" class="color-dim">
                        <li><strong>Python 3.x:</strong> Necesario para ejecutar el código.</li>
                        <li><strong>Pygame:</strong> Instalar con: <code id="pip-command" style="background:#0A0A0A; padding:2px 5px; border-radius:3px;">pip install pygame</code> <button id="copy-btn" title="Copiar al portapapeles" style="background:none; border:none; color:var(--color-accent); cursor:pointer;"><i class="fas fa-copy"></i></button></li>
                        <li><strong>Sistema Operativo:</strong> Compatible con Windows, macOS y Linux.</li>
                    </ul>
                </div>
                <div class="grid-item">
                    <h3><i class="fas fa-check-circle color-accent"></i> Proceso de Lanzamiento</h3>
                    <ol style="list-style:decimal; padding-left:20px;" class="color-dim">
                        <li>Descomprime el archivo ZIP.</li>
                        <li>Abre tu terminal o consola.</li>
                        <li>Navega al directorio del juego.</li>
                        <li>Ejecuta el archivo del menú principal: <code style="background:#0A0A0A; padding:2px 5px; border-radius:3px;">python Menu.py</code></li>
                    </ol>
                </div>
            </div>
        </section>
        
        <section id="overview-content" class="info-section content-section">
            <h2 class="section-title">VISIÓN GENERAL Y FILOSOFÍA DE JUEGO <i class="fas fa-info-circle"></i></h2>
            
            <div class="grid-3">
                <div class="grid-item">
                    <h3><i class="fas fa-balance-scale"></i> Jugabilidad: El Wheelie</h3>
                    <p>El núcleo del juego es mantener el equilibrio de la motocicleta en una rueda (*wheelie*). La inclinación constante y precisa es necesaria para compensar la aceleración y la gravedad.</p>
                </div>
                <div class="grid-item">
                    <h3><i class="fas fa-star"></i> Estilo Pixel Art Clásico</h3>
                    <p>El juego renderiza a una baja resolución interna de <strong>400x200 píxeles</strong> (escalada a <strong>1200x720</strong> en la ventana final), capturando la estética clásica de 16 bits.</p>
                </div>
                <div class="grid-item">
                    <h3><i class="fas fa-money-bill-wave"></i> Progresión y Economía</h3>
                    <p>La moneda se gana a razón de <strong>1$ por cada 10 metros</strong> recorridos. Este dinero es persistente (guardado en `data.json`) y se usa para desbloquear skins y mejoras permanentes.</p>
                </div>
            </div>

            <article class="mt-3" style="border-top: 1px solid var(--color-border); padding-top: 20px;">
                <h3 class="color-accent"><i class="fas fa-award"></i> Lograr la Distancia Máxima</h3>
                <p>El principal desafío es optimizar la velocidad y el arrastre para alcanzar la máxima distancia. Las skins con bonificaciones altas de `acceleration_bonus` y baja `drag_reduction` son clave para batir récords.</p>
                <p class="font-small color-dim">El récord de distancia (`max_distance`) se guarda en `player_data.json` y se actualiza al final de cada bucle de juego.</p>
            </article>
        </section>

        <section id="documentation-content" class="info-section content-section">
            <h2 class="section-title">DOCUMENTACIÓN TÉCNICA Y PARÁMETROS DE FÍSICA <i class="fas fa-book-open"></i></h2>
            
            <div class="grid-2">
                <div>
                    <h3><i class="fas fa-keyboard"></i> Controles Esenciales</h3>
                    <p>El control del equilibrio es vital. Se recomienda práctica para dominar la inercia del piloto:</p>
                    <table class="stats-table">
                        <thead>
                            <tr><th>Tecla</th><th>Función</th><th>Detalles de Acción</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="color-accent fw-bold">W</td>
                                <td>Inclinar hacia adelante</td>
                                <td>Mueve el centro de masa para estabilizar el wheelie.</td>
                            </tr>
                            <tr>
                                <td class="color-accent fw-bold">S</td>
                                <td>Inclinar hacia atrás</td>
                                <td>Contrarresta la caída hacia adelante.</td>
                            </tr>
                            <tr>
                                <td><span class="color-accent fw-bold">A/D</span></td>
                                <td>Aceleración/Frenado</td>
                                <td>Controla el torque del motor. (Asumiendo que el código usa A/D o Izq/Der para movimiento.)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h3><i class="fas fa-cogs"></i> Constantes Físicas Clave</h3>
                    <p>El juego simula la física con los siguientes parámetros base (sujetos a bonificaciones):</p>
                    <table class="stats-table">
                        <thead>
                            <tr><th>Parámetro</th><th>Valor Base</th><th>Unidad</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>PIXELS_PER_METER</strong></td>
                                <td class="color-success">25.0</td>
                                <td>Píxeles/Metro</td>
                            </tr>
                            <tr>
                                <td><strong>FPS</strong></td>
                                <td class="color-success">60</td>
                                <td>Frames/Segundo</td>
                            </tr>
                            <tr>
                                <td><strong>TIME_PER_FRAME</strong></td>
                                <td class="color-success">~0.0167</td>
                                <td>Segundos/Frame</td>
                            </tr>
                            <tr>
                                <td><strong>ACELERACIÓN BASE</strong></td>
                                <td class="color-success">4.0</td>
                                <td>m/s²</td>
                            </tr>
                            <tr>
                                <td><strong>DRAG_COEFFICIENT</strong></td>
                                <td class="color-error">0.006</td>
                                <td>Factor de Resistencia</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <article class="mt-3">
                <h3 class="color-accent"><i class="fas fa-database"></i> Estructura de Datos Persistentes (`player_data.json`)</h3>
                <p>El módulo `player.py` gestiona el guardado. La estructura esperada del archivo JSON es crucial para que el juego funcione sin errores de `KeyError: 'money'`:</p>
                <div style="background-color: #0A0A0A; padding: 15px; border-radius: 4px; border: 1px solid var(--color-border); font-family: monospace; overflow-x: auto; color: #C6C6C6; font-size: 0.85em;">
                    <pre>
{
    "money": 124, 
    "equipped_skin": "negro",
    "max_distance": 1021.616,
    "skins_ownership": {
        "negro": true,
        "rojo": false,
        // ... otras skins
    }
}
                    </pre>
                </div>
            </article>
        </section>

        <section id="shop-content" class="info-section content-section">
            <h2 class="section-title">CATÁLOGO DE SKINS Y BONIFICACIONES <i class="fas fa-store"></i></h2>
            <p class="text-center color-dim">Cada skin ofrece una combinación única de estadísticas. Las bonificaciones se aplican como multiplicadores sobre la física base.</p>
            <div id="dynamic-list" class="grid-3 mt-2">
                </div>
        </section>

        <section id="changelog-content" class="info-section content-section">
            <h2 class="section-title">HISTORIAL DE VERSIONES <i class="fas fa-history"></i></h2>
            <div id="changelog-container">
            </div>
        </section>
    </main>

    <!-- Ventana Modal para Login/Registro -->
    <div id="auth-modal" class="modal-overlay">
        <div class="modal-content">
            <span id="modal-close-btn" class="modal-close-btn">&times;</span>
            
            <!-- Contenedor del formulario de Login -->
            <div id="login-form-container">
                <h2 class="section-title" style="margin-bottom: 20px;">INICIAR SESIÓN</h2>
                <form id="login-form" class="form-container" style="padding:0; background:none;">
                    <div class="form-group">
                        <label for="login-username">Nombre de Usuario</label>
                        <input type="text" id="login-username" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Contraseña</label>
                        <input type="password" id="login-password" name="password" required>
                    </div>
                    <button type="submit" class="form-btn">Entrar</button>
                </form>
            </div>

            <!-- Contenedor del formulario de Registro -->
            <div id="register-form-container" style="display:none;">
                <h2 class="section-title" style="margin-bottom: 20px;">CREAR CUENTA</h2>
                <form id="register-form" class="form-container" style="padding:0; background:none;">
                    <div class="form-group"><label for="register-username">Nombre de Usuario</label><input type="text" id="register-username" name="username" required></div>
                    <div class="form-group"><label for="register-email">Correo Electrónico</label><input type="email" id="register-email" name="email" required></div>
                    <div class="form-group"><label for="register-password">Contraseña</label><input type="password" id="register-password" name="password" required></div>
                    <button type="submit" class="form-btn">Registrar</button>
                </form>
            </div>
        </div>
    </div>


    <script>
        // --- 1. DATOS DEL JUEGO (Extraídos de player.py) ---
        const CURRENT_GAME_VERSION = "1.1.0"; 
        
        const GAME_DATA = {
            "skins": {
                "negro": {"price": 0, "name": "Negro Básico", "acceleration_bonus": 1.0, "top_speed_bonus": 0.0, "drag_reduction": 1.0},
                "rojo": {"price": 500, "name": "Rojo Furia", "acceleration_bonus": 1.1, "top_speed_bonus": 2.0, "drag_reduction": 1.0},
                "verde": {"price": 750, "name": "Verde Neón", "acceleration_bonus": 1.0, "top_speed_bonus": 0.0, "drag_reduction": 0.9},
                "azul": {"price": 1000, "name": "Azul Eléctrico", "acceleration_bonus": 1.15, "top_speed_bonus": 4.0, "drag_reduction": 0.95}
            }
        };

        const CHANGELOG_DATA = [
            {
                version: "1.1.0",
                date: "12/12/2025",
                features: [
                    "Estructura de guardado: Implementación de la clave 'money' en el archivo `data.json` para evitar errores al cargar.",
                    "Física: Ajuste del coeficiente de resistencia del aire (DRAG_COEFFICIENT=0.006) para mayor realismo a alta velocidad.",
                    "Gráficos: Mejora en el renderizado del Parallax del fondo."
                ]
            },
            {
                version: "1.0.0",
                date: "01/12/2025",
                features: [
                    "Lanzamiento inicial con el sistema de física de inclinación.",
                    "Sistema de economía: Gana 1$ por cada 10 metros recorridos."
                ]
            }
        ];

        // --- 2. ESTADO DE LA APLICACIÓN ---
        let currentUser = null; // null si no hay sesión iniciada, o un objeto {username: "..."}

        // --- 3. LÓGICA DE NAVEGACIÓN (SPA) ---
        function showSection(sectionId) {
            // 1. Ocultar todas las secciones de contenido
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // 2. Mostrar la sección deseada y actualizar enlaces
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active');
            }

            // 3. Actualizar el estado activo en los enlaces de navegación
            document.querySelectorAll('.nav-links a[data-target]').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-target') === sectionId) {
                    link.classList.add('active');
                }
            });
        }

        // --- 4. GESTIÓN DE ESTADO DE SESIÓN (UI) ---
        function updateUIForAuthState() {
            const navAuth = document.getElementById('nav-auth-container');
            const navUser = document.getElementById('nav-links-user');
            const userGreeting = document.getElementById('user-greeting');

            if (currentUser) { // Usuario ha iniciado sesión
                navAuth.style.display = 'none';
                navUser.style.display = 'flex';
                userGreeting.textContent = `Hola, ${currentUser.username}`;
            } else { // Usuario no ha iniciado sesión
                navAuth.style.display = 'flex';
                navUser.style.display = 'none';
            }
        }

        // --- 5. LÓGICA DE LA VENTANA MODAL ---
        function openModal(formToShow) {
            const modal = document.getElementById('auth-modal');
            const loginForm = document.getElementById('login-form-container');
            const registerForm = document.getElementById('register-form-container');

            if (formToShow === 'login') {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            }
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('auth-modal').classList.remove('active');
        }

        // --- 6. FUNCIONES DE RENDERIZADO DE CONTENIDO ---

        function renderSkinItem(key, skinData) {
            const statusText = key === 'negro' ? 'Skin Base' : `Precio: $${skinData.price}`;
            
            // Función para formatear bonificaciones
            const formatBonus = (val, type) => {
                let color = '#E0E0E0';
                let text;

                if (type === 'speed_bonus') {
                    // Bonificación absoluta de velocidad máxima
                    color = 'var(--color-info)';
                    text = `+${val.toFixed(1)} km/h`;
                } else if (val > 1.0) {
                    // Bonificación porcentual positiva (Aceleración)
                    color = 'var(--color-success)';
                    text = `+${((val - 1) * 100).toFixed(0)}%`;
                } else if (val < 1.0) {
                    // Bonificación de reducción (Arrastre)
                    color = 'var(--color-info)';
                    text = `x${val.toFixed(2)}`;
                } else {
                    // Neutral
                    color = '#A0A0A0';
                    text = 'x1.0';
                }
                
                return `<span style="color:${color}; font-weight: 600;">${text}</span>`;
            };

            return `
                <div class="grid-item skin-card">
                    <h3 class="color-accent"><i class="fas fa-motorcycle"></i> ${skinData.name}</h3>
                    <p class="color-dim font-small" style="margin-top:-10px;">(${statusText})</p>
                    <ul style="list-style:none; padding:0;" class="font-small">
                        <li><i class="fas fa-bolt color-success"></i> Acel. Multiplicador: ${formatBonus(skinData.acceleration_bonus, 'accel_bonus')}</li>
                        <li><i class="fas fa-angle-double-up color-info"></i> Vel. Máx. Adicional: ${formatBonus(skinData.top_speed_bonus, 'speed_bonus')}</li>
                        <li><i class="fas fa-wind color-info"></i> Arrastre (Coef. Multi.): ${formatBonus(skinData.drag_reduction, 'drag_reduction')}</li>
                    </ul>
                </div>
            `;
        }

        function renderChangelogItem(log) {
            const featuresList = log.features.map(f => `<li><i class="fas fa-caret-right color-success"></i> ${f}</li>`).join('');
            
            return `
                <div class="changelog-item">
                    <h4><i class="fas fa-calendar-alt color-accent"></i> V${log.version} - ${log.date}</h4>
                    <ul style="list-style:none; padding-left: 10px;" class="color-dim">
                        ${featuresList}
                    </ul>
                </div>
            `;
        }
        
        // --- 7. INICIALIZACIÓN Y EVENTOS ---
        document.addEventListener('DOMContentLoaded', () => {
            // Renderizar contenido dinámico (skins y changelog)
            const skinContainer = document.getElementById('dynamic-list');
            if (skinContainer) {
                const skinsHtmlArray = Object.keys(GAME_DATA.skins).map(key => renderSkinItem(key, GAME_DATA.skins[key]));
                skinContainer.innerHTML = skinsHtmlArray.join('');
            }
            
            const changelogContainer = document.getElementById('changelog-container');
            if (changelogContainer) {
                const changelogHtmlArray = CHANGELOG_DATA.map(log => renderChangelogItem(log));
                changelogContainer.innerHTML = changelogHtmlArray.join('');
            }
            
            // Asignar eventos de click a la navegación
            document.querySelectorAll('nav a[data-target]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('data-target');
                    if (targetId) {
                        showSection(targetId);
                    }
                });
            });
            
            // --- Evento para el menú de hamburguesa ---
            document.getElementById('nav-toggle-btn').addEventListener('click', () => {
                document.querySelector('.nav-links').classList.toggle('active');
                // Ocultar los botones de auth/user si el menú principal se abre en móvil
                // (ya que no están dentro del menú colapsable)
            });

            // --- Eventos de la Ventana Modal ---
            document.getElementById('login-modal-btn').addEventListener('click', (e) => {
                e.preventDefault();
                openModal('login');
            });
            document.getElementById('register-modal-btn').addEventListener('click', (e) => {
                e.preventDefault();
                openModal('register');
            });
            document.getElementById('modal-close-btn').addEventListener('click', closeModal);
            document.getElementById('auth-modal').addEventListener('click', (e) => {
                if (e.target.id === 'auth-modal') { // Cierra si se hace clic en el fondo
                    closeModal();
                }
            });

            // Evento para el formulario de registro (simulado)
            document.getElementById('register-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                alert(`¡Registro exitoso para ${username}! Ahora, por favor, inicia sesión.`);
                openModal('login'); // Cambia al formulario de login dentro del modal
            });

            // Evento para el formulario de login (simulado)
            document.getElementById('login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                // Simulación de inicio de sesión exitoso
                currentUser = { username: username };
                closeModal(); // Cierra el modal
                alert(`¡Bienvenido de nuevo, ${username}!`);
                updateUIForAuthState();
            });

            // Evento para cerrar sesión
            document.getElementById('logout-btn').addEventListener('click', (e) => {
                e.preventDefault();
                const username = currentUser.username;
                currentUser = null;
                alert(`¡Hasta pronto, ${username}!`);
                updateUIForAuthState();
            });

            // --- Evento para el botón de copiar ---
            document.getElementById('copy-btn').addEventListener('click', () => {
                const command = document.getElementById('pip-command').innerText;
                navigator.clipboard.writeText(command).then(() => {
                    alert('Comando copiado al portapapeles: ' + command);
                }).catch(err => {
                    console.error('Error al copiar: ', err);
                    alert('No se pudo copiar el comando.');
                });
            });


            // Estado inicial de la UI al cargar la página
            showSection('download-content');
            updateUIForAuthState();
        });
    </script>
</body>
</html>

    <script>
        // --- 1. DATOS DEL JUEGO (Extraídos de player.py) ---
        const CURRENT_GAME_VERSION = "1.1.0"; 
        
        const GAME_DATA = {
            "skins": {
                "negro": {"price": 0, "name": "Negro Básico", "acceleration_bonus": 1.0, "top_speed_bonus": 0.0, "drag_reduction": 1.0},
                "rojo": {"price": 500, "name": "Rojo Furia", "acceleration_bonus": 1.1, "top_speed_bonus": 2.0, "drag_reduction": 1.0},
                "verde": {"price": 750, "name": "Verde Neón", "acceleration_bonus": 1.0, "top_speed_bonus": 0.0, "drag_reduction": 0.9},
                "azul": {"price": 1000, "name": "Azul Eléctrico", "acceleration_bonus": 1.15, "top_speed_bonus": 4.0, "drag_reduction": 0.95}
            }
        };

        const CHANGELOG_DATA = [
            {
                version: "1.1.0",
                date: "12/12/2025",
                features: [
                    "Estructura de guardado: Implementación de la clave 'money' en el archivo `data.json` para evitar errores al cargar.",
                    "Física: Ajuste del coeficiente de resistencia del aire (DRAG_COEFFICIENT=0.006) para mayor realismo a alta velocidad.",
                    "Gráficos: Mejora en el renderizado del Parallax del fondo."
                ]
            },
            {
                version: "1.0.0",
                date: "01/12/2025",
                features: [
                    "Lanzamiento inicial con el sistema de física de inclinación.",
                    "Sistema de economía: Gana 1$ por cada 10 metros recorridos."
                ]
            }
        ];

        // --- 2. LÓGICA DE NAVEGACIÓN (SPA) ---
        // --- 2. ESTADO DE LA APLICACIÓN ---
        let currentUser = null; // null si no hay sesión iniciada, o un objeto {username: "..."}

        // --- 3. LÓGICA DE NAVEGACIÓN (SPA) ---
        function showSection(sectionId) {
            // 1. Ocultar todas las secciones de contenido
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // 2. Mostrar la sección deseada
            // 2. Mostrar la sección deseada y actualizar enlaces
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active');
            }

            // 3. Actualizar el estado activo en la navegación
            document.querySelectorAll('.nav-links a').forEach(link => {
            // 3. Actualizar el estado activo en los enlaces de navegación
            const allLinks = currentUser ? 
                document.querySelectorAll('#nav-links-main a') :
                document.querySelectorAll('#nav-links-auth a');

            allLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-target') === sectionId) {
                    link.classList.add('active');
                }
            });
        }

        // --- 3. FUNCIONES DE RENDERIZADO ---
        // --- 4. GESTIÓN DE ESTADO DE SESIÓN (UI) ---
        function updateUIForAuthState() {
            const navMain = document.getElementById('nav-links-main');
            const navAuth = document.getElementById('nav-links-auth');
            const navUser = document.getElementById('nav-links-user');
            const userGreeting = document.getElementById('user-greeting');

            if (currentUser) { // Sesión iniciada
                navMain.style.display = 'flex';
                navAuth.style.display = 'none';
                navUser.style.display = 'flex';
                userGreeting.textContent = `Hola, ${currentUser.username}`;
                showSection('download-content'); // Mostrar la sección de descarga por defecto
            } else { // Sesión cerrada
                navMain.style.display = 'none';
                navAuth.style.display = 'flex';
                navUser.style.display = 'none';
                showSection('register-content'); // Mostrar la sección de registro por defecto
            }
        }

        // --- 5. FUNCIONES DE RENDERIZADO DE CONTENIDO ---

        function renderSkinItem(key, skinData) {
            const statusText = key === 'negro' ? 'Skin Base' : `Precio: $${skinData.price}`;
            
            // Función para formatear bonificaciones
            const formatBonus = (val, type) => {
                let color = '#E0E0E0';
                let text;

                if (type === 'speed_bonus') {
                    // Bonificación absoluta de velocidad máxima
                    color = '#64B5F6'; // Azul
                    color = 'var(--color-info)';
                    text = `+${val.toFixed(1)} km/h`;
                } else if (val > 1.0) {
                    // Bonificación porcentual positiva (Aceleración)
                    color = '#66BB6A'; // Verde
                    color = 'var(--color-success)';
                    text = `+${((val - 1) * 100).toFixed(0)}%`;
                } else if (val < 1.0) {
                    // Bonificación de reducción (Arrastre)
                    color = '#64B5F6'; // Azul
                    color = 'var(--color-info)';
                    text = `x${val.toFixed(2)}`;
                } else {
                    // Neutral
                    color = '#A0A0A0';
                    text = 'x1.0';
                }
                
                return `<span style="color:${color}; font-weight: 600;">${text}</span>`;
            };

            return `
                <div class="grid-item skin-card">
                    <h3 style="color:var(--color-accent);"><i class="fas fa-motorcycle"></i> ${skinData.name}</h3>
                    <p style="color: var(--color-text-dim); margin-top:-10px; font-size:0.9em;">(${statusText})</p>
                    <ul style="list-style:none; padding:0; font-size:0.9em;">
                        <li><i class="fas fa-bolt" style="color:#66BB6A;"></i> Acel. Multiplicador: ${formatBonus(skinData.acceleration_bonus, 'accel_bonus')}</li>
                        <li><i class="fas fa-angle-double-up" style="color:#64B5F6;"></i> Vel. Máx. Adicional: ${formatBonus(skinData.top_speed_bonus, 'speed_bonus')}</li>
                        <li><i class="fas fa-wind" style="color:#64B5F6;"></i> Arrastre (Coef. Multi.): ${formatBonus(skinData.drag_reduction, 'drag_reduction')}</li>
                    <h3 class="color-accent"><i class="fas fa-motorcycle"></i> ${skinData.name}</h3>
                    <p class="color-dim font-small" style="margin-top:-10px;">(${statusText})</p>
                    <ul style="list-style:none; padding:0;" class="font-small">
                        <li><i class="fas fa-bolt color-success"></i> Acel. Multiplicador: ${formatBonus(skinData.acceleration_bonus, 'accel_bonus')}</li>
                        <li><i class="fas fa-angle-double-up color-info"></i> Vel. Máx. Adicional: ${formatBonus(skinData.top_speed_bonus, 'speed_bonus')}</li>
                        <li><i class="fas fa-wind color-info"></i> Arrastre (Coef. Multi.): ${formatBonus(skinData.drag_reduction, 'drag_reduction')}</li>
                    </ul>
                </div>
            `;
        }

        function renderChangelogItem(log) {
            const featuresList = log.features.map(f => `<li><i class="fas fa-caret-right" style="color:#66BB6A;"></i> ${f}</li>`).join('');
            const featuresList = log.features.map(f => `<li><i class="fas fa-caret-right color-success"></i> ${f}</li>`).join('');
            
            return `
                <div class="changelog-item">
                    <h4><i class="fas fa-calendar-alt" style="color:var(--color-accent);"></i> V${log.version} - ${log.date}</h4>
                    <ul style="list-style:none; padding-left: 10px; color:var(--color-text-dim);">
                    <h4><i class="fas fa-calendar-alt color-accent"></i> V${log.version} - ${log.date}</h4>
                    <ul style="list-style:none; padding-left: 10px;" class="color-dim">
                        ${featuresList}
                    </ul>
                </div>
            `;
        }
        
        // --- 4. INICIALIZACIÓN Y EVENTOS ---
        // --- 6. INICIALIZACIÓN Y EVENTOS ---
        document.addEventListener('DOMContentLoaded', () => {
            // Renderizar contenido dinámico (skins y changelog)
            const skinContainer = document.getElementById('dynamic-list');
            if (skinContainer) {
                const skinsHtmlArray = Object.keys(GAME_DATA.skins).map(key => renderSkinItem(key, GAME_DATA.skins[key]));
                skinContainer.innerHTML = skinsHtmlArray.join('');
            }
            
            const changelogContainer = document.getElementById('changelog-container');
            if (changelogContainer) {
                const changelogHtmlArray = CHANGELOG_DATA.map(log => renderChangelogItem(log));
                changelogContainer.innerHTML = changelogHtmlArray.join('');
            }
            
            // Asignar eventos de click a la navegación
            document.querySelectorAll('.nav-links a').forEach(link => {
            document.querySelectorAll('nav a[data-target]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('data-target');
                    if (targetId) {
                        showSection(targetId);
                    }
                });
            });
            
            // Asegurar que la pestaña de descarga se muestre al cargar
            showSection('download-content');
            // Evento para el formulario de registro (simulado)
            document.getElementById('register-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                alert(`¡Registro exitoso para ${username}! Ahora, por favor, inicia sesión.`);
                // Aquí, en una app real, enviarías los datos a tu servidor.
                // fetch('/api/register', { method: 'POST', body: ... })
                showSection('login-content');
            });

            // Evento para el formulario de login (simulado)
            document.getElementById('login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                // Simulación de inicio de sesión exitoso
                currentUser = { username: username };
                alert(`¡Bienvenido, ${username}!`);
                // Aquí, en una app real, enviarías los datos y recibirías una confirmación.
                // fetch('/api/login', { method: 'POST', body: ... })
                updateUIForAuthState();
            });

            // Evento para cerrar sesión
            document.getElementById('logout-btn').addEventListener('click', (e) => {
                e.preventDefault();
                const username = currentUser.username;
                currentUser = null;
                alert(`¡Hasta pronto, ${username}!`);
                // Aquí, en una app real, harías una llamada al servidor para invalidar la sesión.
                // fetch('/api/logout', { method: 'POST' })
                updateUIForAuthState();
            });


            // Estado inicial de la UI al cargar la página
            updateUIForAuthState();
        });
    </script>
</body>
</html>
